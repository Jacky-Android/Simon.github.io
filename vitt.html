<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- Chrome, Firefox OS and Opera Status Bar Color -->
<meta name="theme-color" content="#FFFFFF">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
<link rel="stylesheet" type="text/css"
  href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
<link rel="stylesheet" type="text/css" href="css/theme.css">
<link rel="stylesheet" type="text/css" href="css/notablog.css">
<!-- Favicon -->

  <link rel="shortcut icon" href="https://avatars.githubusercontent.com/u/55181594?v=4">

<style>
  :root {
    font-size: 20px;
  }
</style>
  <title>Vision-Transformer ç ”ä¹ &nbsp;|&nbsp;Simonâ€™s Blogs</title>
  <meta property="og:type" content="blog">
  <meta property="og:title" content="Vision-Transformer ç ”ä¹ ">
  
  
    <meta property="og:image" content="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ˜¶â€ğŸŒ«ï¸&lt;/text&gt;&lt;/svg&gt;">
  
  <style>
    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
  <a href="index.html">
    <div class="Navbar__Btn">
      
        <span><img class="inline-img-icon" src="https://avatars.githubusercontent.com/u/55181594?v=4"></span>&nbsp;
      
      <span>Home</span>
    </div>
  </a>
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="road.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ¤‘&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>2024å¹´æ·±åº¦å­¦ä¹ å­¦ä¹ è·¯çº¿</span>
        </div>
      </a>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="about.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ˜€&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>About me</span>
        </div>
      </a>
    
  
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="12.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ¤&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>è®­ç»ƒç¥ç»ç½‘ç»œçš„æŠ€å·§</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="HA.html">
        <div class="Navbar__Btn">
          
            <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ˜¶&lt;/text&gt;&lt;/svg&gt;"></span>&nbsp;
          
          <span>HAFormerå¤ç°</span>
        </div>
      </a>
    
  
    
      <span class="Navbar__Delim">&centerdot;</span>
      <a href="ma.html">
        <div class="Navbar__Btn">
          
          <span>â€£ </span>
        </div>
      </a>
    
  
</nav>
  <header class="Header">
    
    <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
    
      <div class="Header__Icon">
        <span><img class="inline-img-icon" src="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text text-anchor=%22middle%22 dominant-baseline=%22middle%22 x=%2250%22 y=%2255%22 font-size=%2280%22&gt;ğŸ˜¶â€ğŸŒ«ï¸&lt;/text&gt;&lt;/svg&gt;"></span>
      </div>
    
    <h1 class="Header__Title">Vision-Transformer ç ”ä¹ </h1>
    
  </header>
  <article id="https://www.notion.so/921945c25fe64f2e92beafdb77ec782b" class="PageRoot"><h2 id="https://www.notion.so/e192411043d84ca9a63b50ff373db0fc" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/e192411043d84ca9a63b50ff373db0fc"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">æ‰€æœ‰attentionæ”¾vit_attentionæ–‡ä»¶å¤¹ä¸‹ï¼ŒåŠæ’åŠç”¨ã€‚</span></span></h2><h3 id="https://www.notion.so/b18a6284ffc74b09872280609c00a96d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/b18a6284ffc74b09872280609c00a96d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">å·²ç»å®ç°</span></span></h3><div id="https://www.notion.so/ef6e6adf747a44da868ddc632a591ce1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://github.com/Jacky-Android/Study-Vision-transformer/blob/main/vit_attention/Vit.py">vsion transformer attention</a></span></span></p></div><div id="https://www.notion.so/d211201cc5a543f09aac9feadfee53c6" class="Bookmark"><a href="https://github.com/Jacky-Android/Study-Vision-transformer/blob/main/vit_attention/swin_att.py"><p class="Bookmark__Link">https://github.com/Jacky-Android/Study-Vision-transformer/blob/main/vit_attention/swin_att.py</p></a></div><h1 id="https://www.notion.so/fe6fce469b904bf681df7abc2994f746" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/fe6fce469b904bf681df7abc2994f746"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Q,K,V</span></span></h1><div id="https://www.notion.so/ac03f3b870c145f48b0dfd4739b79151" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/09e0238f884045d096047b6c649e8e7a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Transformeré‡Œé¢çš„Qï¼ŒKï¼ŒVæ˜¯æŒ‡æŸ¥è¯¢ï¼ˆQueryï¼‰ï¼Œé”®ï¼ˆKeyï¼‰å’Œå€¼ï¼ˆValueï¼‰ä¸‰ä¸ªçŸ©é˜µï¼Œå®ƒä»¬éƒ½æ˜¯é€šè¿‡å¯¹è¾“å…¥è¿›è¡Œçº¿æ€§å˜æ¢å¾—åˆ°çš„ã€‚å®ƒä»¬çš„ä½œç”¨æ˜¯å®ç°ä¸€ç§æ³¨æ„åŠ›æœºåˆ¶ï¼ˆAttentionï¼‰ï¼Œç”¨äºè®¡ç®—è¾“å…¥çš„æ¯ä¸ªå…ƒç´ ï¼ˆtokenï¼‰ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œå¹¶æ ¹æ®ç›¸å…³æ€§å¯¹è¾“å…¥è¿›è¡ŒåŠ æƒå’Œï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„è¾“å‡ºã€‚</span></span></p></div><div id="https://www.notion.so/8e7aa56e86b348889041a89198e2986d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">å…·ä½“æ¥è¯´ï¼ŒæŸ¥è¯¢çŸ©é˜µQç”¨äºè¯¢é—®é”®çŸ©é˜µKä¸­çš„å“ªä¸ªtokenä¸æŸ¥è¯¢æœ€ç›¸ä¼¼ï¼Œé€šè¿‡ç‚¹ç§¯è®¡ç®—å¾—åˆ°ä¸€ä¸ªç›¸ä¼¼åº¦åºåˆ—ã€‚ç„¶åå¯¹ç›¸ä¼¼åº¦åºåˆ—è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œå¾—åˆ°ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œè¡¨ç¤ºæ¯ä¸ªtokenè¢«æ³¨æ„çš„ç¨‹åº¦ã€‚æœ€åï¼Œç”¨è¿™ä¸ªæ¦‚ç‡åˆ†å¸ƒå¯¹å€¼çŸ©é˜µVè¿›è¡ŒåŠ æƒå’Œï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„tokenï¼Œè¡¨ç¤ºæŸ¥è¯¢çš„ç»“æœã€‚</span></span></p></div><div id="https://www.notion.so/283dc6f106e1438a8a1246992ac4d7d4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">è¿™ç§æ³¨æ„åŠ›æœºåˆ¶å¯ä»¥è®©æ¨¡å‹å­¦ä¹ åˆ°è¾“å…¥çš„æ¯ä¸ªå…ƒç´ ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä»è€Œæé«˜æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›å’Œæ€§èƒ½ã€‚Transformeræ¨¡å‹ä¸­ä½¿ç”¨äº†ä¸¤ç§ä¸åŒçš„æ³¨æ„åŠ›æœºåˆ¶ï¼Œåˆ†åˆ«æ˜¯è‡ªæ³¨æ„åŠ›ï¼ˆSelf-Attentionï¼‰å’Œç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›ï¼ˆEncoder-Decoder Attentionï¼‰ã€‚</span></span></p></div><div id="https://www.notion.so/53948fe2763c42b4bc84412bd8664ff2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">è‡ªæ³¨æ„åŠ›æ˜¯æŒ‡Qï¼ŒKï¼ŒVéƒ½æ¥è‡ªäºåŒä¸€ä¸ªè¾“å…¥ï¼Œç”¨äºè®¡ç®—è¾“å…¥çš„æ¯ä¸ªå…ƒç´ ä¸è‡ªèº«çš„ç›¸å…³æ€§ï¼Œä»è€Œæ•æ‰è¾“å…¥çš„å†…éƒ¨ç»“æ„ã€‚ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›æ˜¯æŒ‡Qæ¥è‡ªäºè§£ç å™¨çš„è¾“å‡ºï¼ŒKï¼ŒVæ¥è‡ªäºç¼–ç å™¨çš„è¾“å‡ºï¼Œç”¨äºè®¡ç®—è§£ç å™¨çš„è¾“å‡ºä¸ç¼–ç å™¨çš„è¾“å‡ºçš„ç›¸å…³æ€§ï¼Œä»è€Œæ•æ‰è¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚</span></span></p></div><div id="https://www.notion.so/bebb5e602e19406b8406ca9cc3b4e513" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F0a7613a6-fe60-4bc6-a93e-9a264e1dc794%2FUntitled.png?width=271&amp;table=block&amp;id=bebb5e60-2e19-406b-8406-ca9cc3b4e513"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F0a7613a6-fe60-4bc6-a93e-9a264e1dc794%2FUntitled.png?width=271&amp;table=block&amp;id=bebb5e60-2e19-406b-8406-ca9cc3b4e513" style="width:271px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h2 id="https://www.notion.so/02ddcb2eec9241369f34a3089a4d7b25" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/02ddcb2eec9241369f34a3089a4d7b25"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">QKV Attention</span></span></h2><ul class="BulletedListWrapper"><li id="https://www.notion.so/93c60eb8527b40158871e7c2c8c9c913" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">é¦–å…ˆï¼Œå°†è¾“å…¥çš„ç‰¹å¾å‘é‡ï¼ˆä¾‹å¦‚è¯å‘é‡ï¼‰åˆ†åˆ«ä¹˜ä»¥ä¸‰ä¸ªä¸åŒçš„å¯å­¦ä¹ çš„æƒé‡çŸ©é˜µï¼Œå¾—åˆ°æŸ¥è¯¢çŸ©é˜µï¼ˆquery matrixï¼‰Qï¼Œé”®çŸ©é˜µï¼ˆkey matrixï¼‰Kå’Œå€¼çŸ©é˜µï¼ˆvalue matrixï¼‰Vã€‚è¿™ç›¸å½“äºå¯¹è¾“å…¥çš„ç‰¹å¾å‘é‡è¿›è¡Œäº†ä¸‰ç§ä¸åŒçš„çº¿æ€§å˜æ¢ï¼Œå¾—åˆ°äº†ä¸‰ç§ä¸åŒçš„è¡¨ç¤ºã€‚</span></span></li><li id="https://www.notion.so/306bb96245304071bf33ddfb74a83765" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">ç„¶åï¼Œè®¡ç®—Qå’ŒKçš„ç‚¹ç§¯ï¼Œå¾—åˆ°æ³¨æ„åŠ›çš„å¯¹æ•°å€¼ï¼ˆlogitï¼‰ï¼Œå¹¶ä¹˜ä»¥ä¸€ä¸ªç¼©æ”¾å› å­ï¼ˆscaleï¼‰ï¼Œç”¨äºè°ƒèŠ‚æ³¨æ„åŠ›çš„æƒé‡ã€‚ç¼©æ”¾å› å­é€šå¸¸æ˜¯Kçš„ç»´åº¦çš„å¹³æ–¹æ ¹çš„å€’æ•°ï¼Œç”¨äºé¿å…ç‚¹ç§¯å€¼è¿‡å¤§æˆ–è¿‡å°ï¼Œå½±å“æ¢¯åº¦çš„ç¨³å®šæ€§ã€‚</span></span></li><li id="https://www.notion.so/3a0e7e7db448486ea7c97a7e57147f11" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">æ¥ç€ï¼Œå¯¹æ³¨æ„åŠ›çš„å¯¹æ•°å€¼è¿›è¡Œsoftmaxæ¿€æ´»ï¼Œå¾—åˆ°æ³¨æ„åŠ›çš„æƒé‡ï¼ˆweightï¼‰ï¼Œè¡¨ç¤ºæ¯ä¸ªè¾“å…¥å…ƒç´ è¢«æ³¨æ„çš„ç¨‹åº¦ã€‚æ³¨æ„åŠ›çš„æƒé‡æ˜¯ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œå®ƒçš„å’Œä¸º1ã€‚</span></span></li><li id="https://www.notion.so/55856577b4a44a3d95af25a0d3f5acd9" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">æœ€åï¼Œç”¨æ³¨æ„åŠ›çš„æƒé‡å¯¹Vè¿›è¡ŒåŠ æƒå’Œï¼Œå¾—åˆ°æ³¨æ„åŠ›çš„è¾“å‡ºï¼ˆoutputï¼‰ï¼Œè¡¨ç¤ºæ¯ä¸ªè¾“å…¥å…ƒç´ çš„æ–°çš„è¡¨ç¤ºã€‚æ³¨æ„åŠ›çš„è¾“å‡ºæ˜¯ä¸€ä¸ªåŠ æƒå¹³å‡çš„ç»“æœï¼Œå®ƒçš„ç»´åº¦å’ŒVç›¸åŒã€‚</span></span></li></ul><div id="https://www.notion.so/cd0441975f604f599af87673ba776c15" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">QKV attention è®¡ç®—å…¬å¼å¯ä»¥ç”¨æ•°å­¦å…¬å¼è¡¨ç¤ºä¸ºï¼š</span></span></p></div><p id="https://www.notion.so/0e58a11a0c064dfea3b1a7a5437663db" class="Equation" data-latex="Attention(Q,K,V) = softmax(\frac{QK^T}{\sqrt{d_k}})V
"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy="false">(</mo><mi>Q</mi><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>V</mi><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mfrac><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo stretchy="false">)</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">Attention(Q,K,V) = softmax(\frac{QK^T}{\sqrt{d_k}})V
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault">t</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.448331em;vertical-align:-0.93em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">t</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.25278em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.81722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.18278000000000005em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">Q</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.22222em;">V</span></span></span></span></span></p><div id="https://www.notion.so/a90ff1f78b9d4fc1a9e29d1fb73b8681" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/92bfec638ae44f118b3bcf67bd43fe98" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">å…¶ä¸­ï¼Œdkæ˜¯Kçš„ç»´åº¦ï¼ŒQKTè¡¨ç¤ºQå’ŒKçš„è½¬ç½®çš„ç‚¹ç§¯ï¼Œsoftmaxå‡½æ•°å°†æ³¨æ„åŠ›çš„å¯¹æ•°å€¼å½’ä¸€åŒ–ï¼Œä½¿å¾—å®ƒä»¬çš„å’Œä¸º1ã€‚</span></span></p></div><div id="https://www.notion.so/2f10f0ed996d4ccf9100052d0ea165f5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h1 id="https://www.notion.so/7d573a49793e4598bf72fcdae06f100b" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/7d573a49793e4598bf72fcdae06f100b"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Say something</span></span></h1><div id="https://www.notion.so/51d927f66a684f29adafd4d262787f45" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">å®ç°ä¸€äº›ç»å…¸çš„vit attention ï¼Œä¹Ÿç®—æ˜¯ç¬”è®°ã€‚ğŸ˜ğŸ˜ğŸ˜</span></span></p></div><div id="https://www.notion.so/b9b35c308ad54f2fae7881cf35797f72" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h1 id="https://www.notion.so/4c5a92de07d4459da62d7b62e94ba93f" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/4c5a92de07d4459da62d7b62e94ba93f"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Vision transformer</span></span></h1><div id="https://www.notion.so/fbdb125c53ce43feb3618c773cf3dec1" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2Fa6c3faec-6701-4d8a-a196-a4a79ed0a739%2FUntitled.png?width=711&amp;table=block&amp;id=fbdb125c-53ce-43fe-b361-8c773cf3dec1"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2Fa6c3faec-6701-4d8a-a196-a4a79ed0a739%2FUntitled.png?width=711&amp;table=block&amp;id=fbdb125c-53ce-43fe-b361-8c773cf3dec1" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/f9883e3f7e31430cb9ef179decea73c3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">1) patch embeddingï¼šä¾‹å¦‚è¾“å…¥å›¾ç‰‡å¤§å°ä¸º224x224ï¼Œå°†å›¾ç‰‡åˆ†ä¸ºå›ºå®šå¤§å°çš„patchï¼Œpatchå¤§å°ä¸º16x16ï¼Œåˆ™æ¯å¼ å›¾åƒä¼šç”Ÿæˆ224x224/16x16=196ä¸ªpatchï¼Œå³è¾“å…¥åºåˆ—é•¿åº¦ä¸º</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">196</strong></span><span class="SemanticString">ï¼Œæ¯ä¸ªpatchç»´åº¦16x16x3=</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">768</strong></span><span class="SemanticString">ï¼Œçº¿æ€§æŠ•å°„å±‚çš„ç»´åº¦ä¸º768xN (N=768)ï¼Œå› æ­¤è¾“å…¥é€šè¿‡çº¿æ€§æŠ•å°„å±‚ä¹‹åçš„ç»´åº¦ä¾ç„¶ä¸º196x768ï¼Œå³ä¸€å…±æœ‰196ä¸ªtokenï¼Œæ¯ä¸ªtokençš„ç»´åº¦æ˜¯768ã€‚è¿™é‡Œè¿˜éœ€è¦åŠ ä¸Šä¸€ä¸ªç‰¹æ®Šå­—ç¬¦clsï¼Œå› æ­¤æœ€ç»ˆçš„ç»´åº¦æ˜¯</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">197x768</strong></span><span class="SemanticString">ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå·²ç»é€šè¿‡patch embeddingå°†ä¸€ä¸ªè§†è§‰é—®é¢˜è½¬åŒ–ä¸ºäº†ä¸€ä¸ªseq2seqé—®é¢˜</span></span></p></div><div id="https://www.notion.so/97f1be0e712b41dfb324cc7ae9d04591" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">(2) positional encodingï¼ˆstandard learnable 1D position embeddingsï¼‰ï¼šViTåŒæ ·éœ€è¦åŠ å…¥ä½ç½®ç¼–ç ï¼Œä½ç½®ç¼–ç å¯ä»¥ç†è§£ä¸ºä¸€å¼ è¡¨ï¼Œè¡¨ä¸€å…±æœ‰Nè¡Œï¼ŒNçš„å¤§å°å’Œè¾“å…¥åºåˆ—é•¿åº¦ç›¸åŒï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªå‘é‡ï¼Œå‘é‡çš„ç»´åº¦å’Œè¾“å…¥åºåˆ—embeddingçš„ç»´åº¦ç›¸åŒï¼ˆ768ï¼‰ã€‚æ³¨æ„ä½ç½®ç¼–ç çš„æ“ä½œæ˜¯sumï¼Œè€Œä¸æ˜¯concatã€‚åŠ å…¥ä½ç½®ç¼–ç ä¿¡æ¯ä¹‹åï¼Œç»´åº¦ä¾ç„¶æ˜¯</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">197x768</strong></span></span></p></div><div id="https://www.notion.so/2b28e35787ce4811a41019834643df45" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">(3) LN/multi-head attention/LNï¼šLNè¾“å‡ºç»´åº¦ä¾ç„¶æ˜¯197x768ã€‚å¤šå¤´è‡ªæ³¨æ„åŠ›æ—¶ï¼Œå…ˆå°†è¾“å…¥æ˜ å°„åˆ°qï¼Œkï¼Œvï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªå¤´ï¼Œqkvçš„ç»´åº¦éƒ½æ˜¯197x768ï¼Œå¦‚æœæœ‰12ä¸ªå¤´ï¼ˆ768/12=64ï¼‰ï¼Œåˆ™qkvçš„ç»´åº¦æ˜¯197x64ï¼Œä¸€å…±æœ‰12ç»„qkvï¼Œæœ€åå†å°†12ç»„qkvçš„è¾“å‡ºæ‹¼æ¥èµ·æ¥ï¼Œè¾“å‡ºç»´åº¦æ˜¯197x768ï¼Œç„¶ååœ¨è¿‡ä¸€å±‚LNï¼Œç»´åº¦ä¾ç„¶æ˜¯</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">197x768</strong></span></span></p></div><div id="https://www.notion.so/325aab2c65c34057955561f1e815600e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">(4) MLPï¼šå°†ç»´åº¦æ”¾å¤§å†ç¼©å°å›å»ï¼Œ197x768æ”¾å¤§ä¸º197x3072ï¼Œå†ç¼©å°å˜ä¸º</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">197x768</strong></span></span></p></div><h2 id="https://www.notion.so/fd85f44b9083440e8d9abb7a2b435c47" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/fd85f44b9083440e8d9abb7a2b435c47"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">vision transformerçš„attentionå®ç°</span></span></h2><pre id="https://www.notion.so/2a413fcc25ef4c11a225d008889083d1" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">class</span> <span class="token class-name">Attention</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>
                 dim<span class="token punctuation">,</span>   <span class="token comment"># è¾“å…¥tokençš„dim</span>
                 num_heads<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span>
                 qkv_bias<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
                 qk_scale<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>
                 attn_drop_ratio<span class="token operator">=</span><span class="token number">0.</span><span class="token punctuation">,</span>
                 proj_drop_ratio<span class="token operator">=</span><span class="token number">0.</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token builtin">super</span><span class="token punctuation">(</span>Attention<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>num_heads <span class="token operator">=</span> num_heads
        head_dim <span class="token operator">=</span> dim <span class="token operator">//</span> num_heads
        self<span class="token punctuation">.</span>scale <span class="token operator">=</span> qk_scale <span class="token keyword">or</span> head_dim <span class="token operator">**</span> <span class="token operator">-</span><span class="token number">0.5</span>
        self<span class="token punctuation">.</span>qkv <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>dim<span class="token punctuation">,</span> dim <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">,</span> bias<span class="token operator">=</span>qkv_bias<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>attn_drop <span class="token operator">=</span> nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span>attn_drop_ratio<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>proj <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>dim<span class="token punctuation">,</span> dim<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>proj_drop <span class="token operator">=</span> nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span>proj_drop_ratio<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># [batch_size, num_patches + 1, total_embed_dim]</span>
        B<span class="token punctuation">,</span> N<span class="token punctuation">,</span> C <span class="token operator">=</span> x<span class="token punctuation">.</span>shape

        <span class="token comment"># qkv(): -> [batch_size, num_patches + 1, 3 * total_embed_dim]</span>
        <span class="token comment"># reshape: -> [batch_size, num_patches + 1, 3, num_heads, embed_dim_per_head]</span>
        <span class="token comment"># permute: -> [3, batch_size, num_heads, num_patches + 1, embed_dim_per_head]</span>
        qkv <span class="token operator">=</span> self<span class="token punctuation">.</span>qkv<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>B<span class="token punctuation">,</span> N<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>num_heads<span class="token punctuation">,</span> C <span class="token operator">//</span> self<span class="token punctuation">.</span>num_heads<span class="token punctuation">)</span><span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
        <span class="token comment"># [batch_size, num_heads, num_patches + 1, embed_dim_per_head]</span>
        q<span class="token punctuation">,</span> k<span class="token punctuation">,</span> v <span class="token operator">=</span> qkv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> qkv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> qkv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>  <span class="token comment"># make torchscript happy (cannot use tensor as tuple)</span>

        <span class="token comment"># transpose: -> [batch_size, num_heads, embed_dim_per_head, num_patches + 1]</span>
        <span class="token comment"># @: multiply -> [batch_size, num_heads, num_patches + 1, num_patches + 1]</span>
        attn <span class="token operator">=</span> <span class="token punctuation">(</span>q @ k<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>scale
        attn <span class="token operator">=</span> attn<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        attn <span class="token operator">=</span> self<span class="token punctuation">.</span>attn_drop<span class="token punctuation">(</span>attn<span class="token punctuation">)</span>

        <span class="token comment"># @: multiply -> [batch_size, num_heads, num_patches + 1, embed_dim_per_head]</span>
        <span class="token comment"># transpose: -> [batch_size, num_patches + 1, num_heads, embed_dim_per_head]</span>
        <span class="token comment"># reshape: -> [batch_size, num_patches + 1, total_embed_dim]</span>
        x <span class="token operator">=</span> <span class="token punctuation">(</span>attn @ v<span class="token punctuation">)</span><span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>B<span class="token punctuation">,</span> N<span class="token punctuation">,</span> C<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>proj<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>proj_drop<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        <span class="token keyword">return</span> x</span></span></span></code></pre><h1 id="https://www.notion.so/4b67c5f6111a4e47abf6ee21d16fd1ff" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/4b67c5f6111a4e47abf6ee21d16fd1ff"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Swin Tranformer</span></span></h1><h2 id="https://www.notion.so/6e0661914a0445b7bc8ccd4a8e361de7" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/6e0661914a0445b7bc8ccd4a8e361de7"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">æ¡†æ¶</span></span></h2><div id="https://www.notion.so/8235e1536b494bb5bdcfbfd845b199b4" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F43e90388-9d71-4270-bca1-b90b4dc217d9%2FUntitled.png?width=1302&amp;table=block&amp;id=8235e153-6b49-4bb5-bdcf-bfd845b199b4"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F43e90388-9d71-4270-bca1-b90b4dc217d9%2FUntitled.png?width=1302&amp;table=block&amp;id=8235e153-6b49-4bb5-bdcf-bfd845b199b4" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/e1198a576ddc481fa0824197d59d69ae" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">Swin Transformerï¼ˆä¸Šå›¾ä¸º Swin-Tï¼ŒT ä¸º Tinyï¼‰é¦–å…ˆé€šè¿‡è¡¥ä¸åˆ†å‰²æ¨¡å—ï¼ˆå¦‚</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://sh-tsang.medium.com/review-vision-transformer-vit-406568603de0">ViTï¼‰</a></span><span class="SemanticString">å°†è¾“å…¥ RGB å›¾åƒåˆ†å‰²ä¸ºä¸é‡å çš„è¡¥ä¸ã€‚</span></span></li><li id="https://www.notion.so/7a481d78a4674382ac4708b8b8147319" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">æ¯ä¸ªè¡¥ä¸éƒ½è¢«è§†ä¸ºä¸€ä¸ªâ€œä»¤ç‰Œâ€ï¼Œå…¶ç‰¹å¾è¢«è®¾ç½®ä¸ºåŸå§‹åƒç´  RGB å€¼çš„ä¸²è”ã€‚ä½¿ç”¨</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">4Ã—4 çš„ patch å¤§å°ï¼Œå› æ­¤æ¯ä¸ª patch çš„ç‰¹å¾ç»´åº¦ä¸º 4Ã—4Ã—3=48</strong></span><span class="SemanticString">ã€‚çº¿æ€§åµŒå…¥å±‚åº”ç”¨äºè¯¥åŸå§‹å€¼ç‰¹å¾ï¼Œå°†</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">å…¶æŠ•å½±åˆ°ä»»æ„ç»´åº¦</strong></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">C</strong></em></span><span class="SemanticString">ã€‚</span></span></li><li id="https://www.notion.so/0733d2be96f349eeb7894de850ea21fd" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">ä¸ºäº†äº§ç”Ÿ</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">åˆ†å±‚è¡¨ç¤º</strong></span><span class="SemanticString">ï¼Œéšç€ç½‘ç»œå˜å¾—æ›´æ·±ï¼Œé€šè¿‡è¡¥ä¸åˆå¹¶å±‚æ¥å‡å°‘æ ‡è®°çš„æ•°é‡ã€‚ç¬¬ä¸€ä¸ªè¡¥ä¸åˆå¹¶å±‚</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">è¿æ¥æ¯ç»„ 2Ã—2 ç›¸é‚»è¡¥ä¸çš„ç‰¹å¾ï¼Œå¹¶åœ¨4Â </strong></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">C</strong></em></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">ç»´è¿æ¥ç‰¹å¾</strong></span><span class="SemanticString">ä¸Šåº”ç”¨çº¿æ€§å±‚ã€‚è¿™</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">å°†ä»¤ç‰Œæ•°é‡å‡å°‘äº† 2Ã—2 = 4 çš„å€æ•°</strong></span><span class="SemanticString">ï¼ˆ2 æ¬¡åˆ†è¾¨ç‡ä¸‹é‡‡æ ·ï¼‰</span></span></li><li id="https://www.notion.so/283149b2fbd4433ebbc3d07f2fb38215" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">è¾“å‡º</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">å°ºå¯¸</strong></span><span class="SemanticString">è®¾ç½®ä¸º</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">2Â </strong></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">C</strong></em></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">ï¼Œ</em></span><span class="SemanticString">åˆ†è¾¨ç‡ä¿æŒä¸º</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">H</strong></em></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Â /8Ã—Â </strong></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">W</strong></em></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Â /8</strong></span><span class="SemanticString">ã€‚è¡¥ä¸åˆå¹¶å’Œç‰¹å¾è½¬æ¢çš„ç¬¬ä¸€ä¸ªå—è¢«è¡¨ç¤ºä¸º</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">â€œé˜¶æ®µ 2â€</strong></span><span class="SemanticString">ã€‚</span></span></li><li id="https://www.notion.so/e9a7da08af854368a916477814194168" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">åœ¨æ¯ä¸ª MSA æ¨¡å—å’Œæ¯ä¸ª MLP ä¹‹å‰åº”ç”¨ LayerNorm (LN) å±‚ï¼Œå¹¶åœ¨</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">æ¯ä¸ª</strong></span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://sh-tsang.medium.com/review-layer-normalization-ln-6c2ae88bae47"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">æ¨¡å—</strong></a></span><span class="SemanticString">ä¹‹ååº”ç”¨</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">æ®‹å·®è¿æ¥ã€‚</strong></span></span></li></ul><h2 id="https://www.notion.so/433f700aa1ff42dd8a8bf04868d0c672" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/433f700aa1ff42dd8a8bf04868d0c672"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Shifted Window Based Self-Attention</strong></strong></span></span></h2><h3 id="https://www.notion.so/53f808744c4f4c25981930c706510c1a" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/53f808744c4f4c25981930c706510c1a"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Window Based Self-Attention (W-MSA)</strong></strong></span></span></h3><div id="https://www.notion.so/5f8e0de73862436ab33c839e514b7d05" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F3f0b06b0-513c-4de2-b388-f7e2f8642e5b%2FUntitled.png?width=462&amp;table=block&amp;id=5f8e0de7-3862-436a-b33c-839e514b7d05"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F3f0b06b0-513c-4de2-b388-f7e2f8642e5b%2FUntitled.png?width=462&amp;table=block&amp;id=5f8e0de7-3862-436a-b33c-839e514b7d05" style="width:462px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/26891c948e1e485ba798353c2081e64e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">å‡è®¾æ¯ä¸ªçª—å£åŒ…å«</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">M</strong></em></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Â Ã—Â </strong></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">M ä¸ª</strong></em></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">patch</strong></span><span class="SemanticString">ï¼Œå…¨å±€ MSA æ¨¡å—å’ŒåŸºäº</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">h</strong></em></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Â Ã—Â </strong></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">w</strong></em></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">ä¸ªpatchå›¾åƒ</strong></span><span class="SemanticString">çš„çª—å£çš„è®¡ç®—å¤æ‚åº¦ä¸ºï¼š</span></span></p></div><div id="https://www.notion.so/e6b584dbf0194234b6c066c46448cc30" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F7ec378fa-a36f-44e3-809f-a1efc460ef6f%2FUntitled.png?width=390&amp;table=block&amp;id=e6b584db-f019-4234-b6c0-66c46448cc30"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F7ec378fa-a36f-44e3-809f-a1efc460ef6f%2FUntitled.png?width=390&amp;table=block&amp;id=e6b584db-f019-4234-b6c0-66c46448cc30" style="width:390px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/df7e01ac79e44ca28d56739168ba1ea6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">å…¶ä¸­å‰è€…ä¸è¡¥ä¸å·</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">hw</em></span><span class="SemanticString">æˆäºŒæ¬¡æ–¹ï¼Œåè€…</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">åœ¨</strong></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">M</strong></em></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">å›ºå®šï¼ˆé»˜è®¤è®¾ç½®ä¸º 7ï¼‰</strong></span><span class="SemanticString">æ—¶å‘ˆçº¿æ€§ã€‚</span></span></p></div><h3 id="https://www.notion.so/7bb082527626433f8c0685895c78a780" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/7bb082527626433f8c0685895c78a780"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Window Based Self-Attention (W-MSA)</strong></strong></span></span></h3><ul class="BulletedListWrapper"><li id="https://www.notion.so/ba109964c0a04e82a734a391c80e061e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">åŸºäºçª—å£çš„è‡ªæ³¨æ„åŠ›æ¨¡å—</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">ç¼ºä¹è·¨çª—å£çš„è¿æ¥</strong></span><span class="SemanticString">ï¼Œè¿™é™åˆ¶äº†å®ƒçš„å»ºæ¨¡èƒ½åŠ›ã€‚</span></span></li><li id="https://www.notion.so/3860f1dce6e943d49f90e0ffb170104c" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">æå‡ºäº†ä¸€ç§ç§»ä½çª—å£åˆ†åŒºæ–¹æ³•ï¼Œè¯¥æ–¹æ³•</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">åœ¨è¿ç»­ Swin Transformer å—ä¸­çš„ä¸¤ä¸ªåˆ†åŒºé…ç½®ä¹‹é—´äº¤æ›¿</strong></span><span class="SemanticString">ã€‚</span></span></li></ul><div id="https://www.notion.so/a559fa877d3c4496a692c41f049d49e2" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F65121772-9696-4830-8a42-72a872b0cbcd%2FUntitled.png?width=448&amp;table=block&amp;id=a559fa87-7d3c-4496-a692-c41f049d49e2"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F65121772-9696-4830-8a42-72a872b0cbcd%2FUntitled.png?width=448&amp;table=block&amp;id=a559fa87-7d3c-4496-a692-c41f049d49e2" style="width:448px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/ec876677675c4ed69fa96b356db15878" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">â€¢ å…¶ä¸­</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">zl</em></span><span class="SemanticString">Â -1 æ˜¯å‰ä¸€å±‚çš„è¾“å‡ºç‰¹å¾ã€‚</span></span></p></div><div id="https://www.notion.so/14ec823d54484203866b0f789e064ac0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"> åœ¨è®¡ç®—ç›¸ä¼¼æ€§æ—¶ï¼Œæ¯ä¸ªå¤´éƒ½åŒ…å«</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">ç›¸å¯¹ä½ç½®åå·®</strong></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Bã€‚</strong></em></span></span></p></div><div id="https://www.notion.so/efc3fc59498947768829e0e6a9e8a173" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F956e0376-aff5-4f8e-964c-67284a7ecef5%2FUntitled.png?width=552&amp;table=block&amp;id=efc3fc59-4989-4776-8829-e0e6a9e8a173"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F956e0376-aff5-4f8e-964c-67284a7ecef5%2FUntitled.png?width=552&amp;table=block&amp;id=efc3fc59-4989-4776-8829-e0e6a9e8a173" style="width:552px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h2 id="https://www.notion.so/673128ce56db4a82914332a4fda4c416" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/673128ce56db4a82914332a4fda4c416"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">ç»†èŠ‚</span></span></h2><h3 id="https://www.notion.so/09214b31dc0f43138b825b41749fec70" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/09214b31dc0f43138b825b41749fec70"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">window_partition</span></span></h3><div id="https://www.notion.so/964c359a651048e4ac8c08539fcbbd36" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">æˆ‘å¤ç°çš„ä»£ç å¦‚ä¸‹</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/e51302bd49e4445f99032f530da610a4" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">é¦–å…ˆï¼Œå°†è¾“å…¥çš„å›¾åƒå¼ é‡xï¼ˆB, C,H, Wï¼‰æŒ‰ç…§çª—å£å¤§å°window_sizeåˆ’åˆ†ä¸ºï¼ˆB, C,H // window_size, window_size, W // window_size, window_sizeï¼‰çš„å½¢çŠ¶ï¼Œå…¶ä¸­Bæ˜¯æ‰¹é‡å¤§å°ï¼ŒHæ˜¯å›¾åƒé«˜åº¦ï¼ŒWæ˜¯å›¾åƒå®½åº¦ï¼ŒCæ˜¯é€šé“æ•°ã€‚</span></span></li><li id="https://www.notion.so/e044ab9948a443c784aacb36e3ac4a7a" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">ç„¶åï¼Œå°†xåœ¨ç¬¬äºŒç»´å’Œç¬¬å››ç»´ä¸Šè¿›è¡Œäº¤æ¢ï¼Œå¾—åˆ°ï¼ˆB, C, W // window_size, H // window_size, window_size, window_sizeï¼‰çš„å½¢çŠ¶ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ¯ä¸ªçª—å£å†…éƒ¨çš„å…ƒç´ æ˜¯è¿ç»­å­˜å‚¨çš„ã€‚</span></span></li><li id="https://www.notion.so/d68dc7071575489d8446be922e4955d4" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">æœ€åï¼Œå°†xå±•å¹³ä¸ºï¼ˆnum_windows * B, window_size, window_size, Cï¼‰çš„å½¢çŠ¶ï¼Œå…¶ä¸­</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">num_windows = (H // window_size) * (W // window_size)</strong></em></span><span class="SemanticString">æ˜¯æ¯å¼ å›¾åƒåˆ’åˆ†å‡ºçš„çª—å£æ•°é‡ã€‚</span></span></li></ul><div id="https://www.notion.so/e86242c15eab4ec1bb2fd3a321d74bb4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">è¾“å…¥feature mapä¸º [1,128,32,32] ï¼Œè¾“å‡ºå½¢çŠ¶ä¸º [16,64,128] çš„tokens</span></span></p></div><pre id="https://www.notion.so/6867b140d9154129aad2b22a38ecc9e4" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">def</span> <span class="token function">img2windows</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> H_sp<span class="token punctuation">,</span> W_sp<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    img: B C H W
    """</span>
    B<span class="token punctuation">,</span> C<span class="token punctuation">,</span> H<span class="token punctuation">,</span> W <span class="token operator">=</span> img<span class="token punctuation">.</span>shape
    img_reshape <span class="token operator">=</span> img<span class="token punctuation">.</span>view<span class="token punctuation">(</span>B<span class="token punctuation">,</span> C<span class="token punctuation">,</span> H <span class="token operator">//</span> H_sp<span class="token punctuation">,</span> H_sp<span class="token punctuation">,</span> W <span class="token operator">//</span> W_sp<span class="token punctuation">,</span> W_sp<span class="token punctuation">)</span>
     <span class="token comment"># [batch_size*num_windows, Mh*Mw, total_embed_dim]</span>
    img_perm <span class="token operator">=</span> img_reshape<span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>contiguous<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> H_sp <span class="token operator">*</span> W_sp<span class="token punctuation">,</span> C<span class="token punctuation">)</span>
    <span class="token keyword">return</span> img_perm
</span></span></span></code></pre><h3 id="https://www.notion.so/6f81302452d940f8bb6d953d20e6fb86" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/6f81302452d940f8bb6d953d20e6fb86"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">windows attention</span></span></h3><div id="https://www.notion.so/9031b8468ecd4e74a8634e60b0aa19e7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">å‚ç…§å®˜æ–¹ä»£ç ï¼š</span></span></p></div><div id="https://www.notion.so/c6121f09744e4b2585cc08aa8dbce262" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">è¿™æ®µä»£ç æ˜¯å®šä¹‰ä¸€ä¸ªåŸºäºçª—å£çš„å¤šå¤´è‡ªæ³¨æ„åŠ›æ¨¡å—çš„ç±»ï¼Œå®ƒå¯ä»¥å®ç°shiftedå’Œnon-shiftedä¸¤ç§çª—å£åˆ’åˆ†æ–¹å¼ï¼Œå¹¶ä¸”åŠ å…¥äº†ç›¸å¯¹ä½ç½®åç½®ã€‚å®ƒçš„ä¸»è¦åŠŸèƒ½å’Œå‚æ•°å¦‚ä¸‹ï¼š</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/15ec54c7f56a43c7a65b898ee71aea88" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">__init__</strong></code></span><span class="SemanticString">æ–¹æ³•æ˜¯åˆå§‹åŒ–æ¨¡å—çš„å‚æ•°ï¼ŒåŒ…æ‹¬è¾“å…¥é€šé“æ•°dimï¼Œçª—å£å¤§å°window_sizeï¼Œæ³¨æ„åŠ›å¤´æ•°num_headsï¼Œä»¥åŠä¸€äº›å¯é€‰çš„å‚æ•°ï¼Œå¦‚qkv_biasï¼Œqk_scaleï¼Œattn_dropå’Œproj_dropã€‚è¿™äº›å‚æ•°åˆ†åˆ«æ§åˆ¶äº†æ˜¯å¦ç»™æŸ¥è¯¢ã€é”®ã€å€¼æ·»åŠ å¯å­¦ä¹ çš„åç½®ï¼ŒæŸ¥è¯¢å’Œé”®çš„ç¼©æ”¾å› å­ï¼Œæ³¨æ„åŠ›æƒé‡çš„dropoutæ¯”ä¾‹ï¼Œä»¥åŠè¾“å‡ºçš„dropoutæ¯”ä¾‹ã€‚æ­¤å¤–ï¼Œè¿™ä¸ªæ–¹æ³•è¿˜å®šä¹‰äº†ä¸€ä¸ªç›¸å¯¹ä½ç½®åç½®è¡¨relative_position_bias_tableï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯å­¦ä¹ çš„å¼ é‡ï¼Œç”¨æ¥å­˜å‚¨æ¯ä¸ªçª—å£å†…éƒ¨æ¯å¯¹ä½ç½®ä¹‹é—´çš„ç›¸å¯¹ä½ç½®åç½®ã€‚å®ƒçš„å½¢çŠ¶æ˜¯(2 * window_size[0] - 1) * (2 * window_size[1] - 1), num_heads)ï¼Œè¡¨ç¤ºæ¯ä¸ªå¤´æœ‰(2 * window_size[0] - 1) * (2 * window_size[1] - 1)ç§ä¸åŒçš„ç›¸å¯¹ä½ç½®å…³ç³»ã€‚è¿™ä¸ªæ–¹æ³•è¿˜æ³¨å†Œäº†ä¸€ä¸ªç¼“å†²åŒºrelative_position_indexï¼Œå®ƒæ˜¯ä¸€ä¸ªå›ºå®šçš„å¼ é‡ï¼Œç”¨æ¥è®°å½•æ¯ä¸ªçª—å£å†…éƒ¨æ¯å¯¹ä½ç½®ä¹‹é—´çš„ç›¸å¯¹ä½ç½®ç´¢å¼•ã€‚å®ƒçš„å½¢çŠ¶æ˜¯window_size[0] * window_size[1], window_size[0] * window_size[1]ï¼‰ï¼Œè¡¨ç¤ºæ¯ä¸ªçª—å£æœ‰window_size[0] * window_size[1]ä¸ªä½ç½®ï¼Œæ¯ä¸ªä½ç½®ä¸å…¶ä»–ä½ç½®ä¹‹é—´æœ‰ä¸€ä¸ªç›¸å¯¹ä½ç½®ç´¢å¼•ï¼ŒèŒƒå›´æ˜¯0åˆ°(2 * window_size[0] - 1) * (2 * window_size[1] - 1) - 1ã€‚</span></span></li><li id="https://www.notion.so/b29eb561fa8e4f8bac011829e368c1dc" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">forward</strong></code></span><span class="SemanticString">æ–¹æ³•æ˜¯æ‰§è¡Œæ¨¡å—çš„å‰å‘è®¡ç®—ï¼Œå®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼šxå’Œmaskã€‚xæ˜¯è¾“å…¥ç‰¹å¾ï¼Œå®ƒçš„å½¢çŠ¶æ˜¯(num_windows*B, N, C)ï¼Œå…¶ä¸­num_windowsæ˜¯æ¯å¼ å›¾åƒåˆ’åˆ†å‡ºçš„çª—å£æ•°é‡ï¼ŒBæ˜¯æ‰¹é‡å¤§å°ï¼ŒNæ˜¯æ¯ä¸ªçª—å£å†…éƒ¨çš„ä½ç½®æ•°é‡ï¼ˆç­‰äºwindow_size[0] * window_size[1]ï¼‰ï¼ŒCæ˜¯é€šé“æ•°ã€‚maskæ˜¯ä¸€ä¸ªå¯é€‰çš„å‚æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ©ç å¼ é‡ï¼Œç”¨æ¥å±è”½ä¸€äº›ä¸éœ€è¦è®¡ç®—æ³¨æ„åŠ›çš„ä½ç½®ã€‚å®ƒçš„å½¢çŠ¶æ˜¯(num_windows, N, N)ï¼Œå…¶ä¸­num_windowså’ŒNä¸xç›¸åŒã€‚å¦‚æœæ²¡æœ‰æä¾›maskï¼Œåˆ™é»˜è®¤ä¸ºNoneã€‚è¿™ä¸ªæ–¹æ³•çš„ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š</span></span><ul class="BulletedListWrapper"><li id="https://www.notion.so/ad41a5de4c6a447883099821c2e32561" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">é¦–å…ˆï¼Œè°ƒç”¨self.qkv(x)å¾—åˆ°æŸ¥è¯¢ã€é”®ã€å€¼ä¸‰ä¸ªå¼ é‡ï¼Œå¹¶å°†å®ƒä»¬é‡å¡‘ä¸º(B_, N, 3, self.num_heads, C // self.num_heads)çš„å½¢çŠ¶ï¼Œå¹¶åœ¨ç¬¬ä¸€ç»´å’Œç¬¬ä¸‰ç»´ä¸Šè¿›è¡Œäº¤æ¢ï¼Œå¾—åˆ°(3, B_, self.num_heads, N, C // self.num_heads)çš„å½¢çŠ¶ã€‚ç„¶åå°†è¿™ä¸ªå¼ é‡åˆ†è§£ä¸ºq, k, vä¸‰ä¸ªå¼ é‡ï¼Œåˆ†åˆ«è¡¨ç¤ºæŸ¥è¯¢ã€é”®ã€å€¼ã€‚</span></span></li><li id="https://www.notion.so/0a594e20da194a86b9fd5abdeceb828b" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">ç„¶åï¼Œå°†qä¹˜ä»¥self.scaleå¾—åˆ°ç¼©æ”¾åçš„æŸ¥è¯¢ï¼Œå¹¶ä¸kè¿›è¡Œè½¬ç½®çŸ©é˜µä¹˜æ³•å¾—åˆ°æ³¨æ„åŠ›å¾—åˆ†å¼ é‡attnã€‚å®ƒçš„å½¢çŠ¶æ˜¯(B_, self.num_heads, N, N)ï¼Œè¡¨ç¤ºæ¯ä¸ªå¤´æ¯ä¸ªçª—å£å†…éƒ¨æ¯å¯¹ä½ç½®ä¹‹é—´çš„æ³¨æ„åŠ›å¾—åˆ†ã€‚</span></span></li><li id="https://www.notion.so/fcb3afb40da2468ea09b9ef5998d674e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">æ¥ç€ï¼Œæ ¹æ®self.relative_position_indexä»self.relative_position_bias_tableä¸­å–å‡ºç›¸åº”çš„ç›¸å¯¹ä½ç½®åç½®ï¼Œå¹¶å°†å…¶é‡å¡‘ä¸º(self.window_size[0] * self.window_size[1], self.window_size[0] * self.window_size[1], -1)çš„å½¢çŠ¶ï¼Œå¹¶åœ¨ç¬¬ä¸€ç»´å’Œç¬¬ä¸‰ç»´ä¸Šè¿›è¡Œäº¤æ¢ï¼Œå¾—åˆ°(-1, self.window_size[0] * self.window_size[1], self.window_size[0] * self.window_size[1])çš„å½¢çŠ¶ã€‚ç„¶åå°†å…¶åœ¨ç¬¬é›¶ç»´ä¸Šå¢åŠ ä¸€ä¸ªç»´åº¦ï¼Œå¹¶ä¸attnç›¸åŠ å¾—åˆ°åŠ å…¥äº†ç›¸å¯¹ä½ç½®åç½®çš„æ³¨æ„åŠ›å¾—åˆ†å¼ é‡attnã€‚</span></span></li><li id="https://www.notion.so/fcadae19d0924bffa3dc55829debb716" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">ç„¶åï¼Œå¦‚æœæä¾›äº†maskï¼Œåˆ™å°†attné‡å¡‘ä¸º(B_ // nW, nW, self.num_heads, N, N)çš„å½¢çŠ¶ï¼Œå¹¶åœ¨ç¬¬ä¸€ç»´å’Œç¬¬äºŒç»´ä¸Šå¢åŠ ä¸€ä¸ªç»´åº¦ï¼Œä¸maskç›¸åŠ å¾—åˆ°å±è”½äº†ä¸€äº›ä½ç½®çš„æ³¨æ„åŠ›å¾—åˆ†å¼ é‡attnã€‚ç„¶åå°†å…¶é‡å¡‘ä¸º(-1, self.num_heads, N, N)çš„å½¢çŠ¶ã€‚å¦‚æœæ²¡æœ‰æä¾›maskï¼Œåˆ™ç›´æ¥å°†attné€šè¿‡self.softmaxå‡½æ•°å¾—åˆ°æ³¨æ„åŠ›æƒé‡å¼ é‡attnï¼Œå¹¶å¯¹å…¶è¿›è¡Œself.attn_dropæ“ä½œã€‚</span></span></li><li id="https://www.notion.so/c0c2057b9ed1411b956a523c9a899f24" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">æœ€åï¼Œå°†attnä¸vè¿›è¡ŒçŸ©é˜µä¹˜æ³•å¾—åˆ°è¾“å‡ºç‰¹å¾xï¼Œå¹¶å°†å…¶åœ¨ç¬¬ä¸€ç»´å’Œç¬¬äºŒç»´ä¸Šè¿›è¡Œäº¤æ¢ï¼Œå¹¶é‡å¡‘ä¸º(B_, N, C)çš„å½¢çŠ¶ã€‚ç„¶åé€šè¿‡self.proj(x)å¾—åˆ°æœ€ç»ˆçš„è¾“å‡ºç‰¹å¾xï¼Œå¹¶å¯¹å…¶è¿›è¡Œself.proj_dropæ“ä½œã€‚è¿”å›xä½œä¸ºæ¨¡å—çš„è¾“å‡ºã€‚</span></span></li></ul></li></ul><div id="https://www.notion.so/e30115a4c48b42adac2d46ce0640445b" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F4abc1b76-6cb5-46a7-b02d-146bf571ab9f%2FUntitled.png?width=720&amp;table=block&amp;id=e30115a4-c48b-42ad-ac2d-46ce0640445b"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F4abc1b76-6cb5-46a7-b02d-146bf571ab9f%2FUntitled.png?width=720&amp;table=block&amp;id=e30115a4-c48b-42ad-ac2d-46ce0640445b" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/12beaa7f00184255901ae5cd882b0e18" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2Fb5bbcca0-e9be-4a27-ba09-cc08c27abcfc%2FUntitled.png?width=720&amp;table=block&amp;id=12beaa7f-0018-4255-901a-e5cd882b0e18"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2Fb5bbcca0-e9be-4a27-ba09-cc08c27abcfc%2FUntitled.png?width=720&amp;table=block&amp;id=12beaa7f-0018-4255-901a-e5cd882b0e18" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><pre id="https://www.notion.so/036a4db46177433aa6b895e5435f9245" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">class</span> <span class="token class-name">WindowAttention</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dim<span class="token punctuation">,</span> window_size<span class="token punctuation">,</span> num_heads<span class="token punctuation">,</span> qkv_bias<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> qk_scale<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> attn_drop<span class="token operator">=</span><span class="token number">0.</span><span class="token punctuation">,</span> proj_drop<span class="token operator">=</span><span class="token number">0.</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>dim <span class="token operator">=</span> dim
    self<span class="token punctuation">.</span>window_size <span class="token operator">=</span> window_size  <span class="token comment"># Wh, Ww</span>
    self<span class="token punctuation">.</span>num_heads <span class="token operator">=</span> num_heads
    head_dim <span class="token operator">=</span> dim <span class="token operator">//</span> num_heads
    self<span class="token punctuation">.</span>scale <span class="token operator">=</span> qk_scale <span class="token keyword">or</span> head_dim <span class="token operator">**</span> <span class="token operator">-</span><span class="token number">0.5</span>

    <span class="token comment"># define a parameter table of relative position bias</span>
    self<span class="token punctuation">.</span>relative_position_bias_table <span class="token operator">=</span> nn<span class="token punctuation">.</span>Parameter<span class="token punctuation">(</span>
        torch<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> window_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> window_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> num_heads<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 2*Wh-1 * 2*Ww-1, nH</span>

    <span class="token comment"># get pair-wise relative position index for each token inside the window</span>
    coords_h <span class="token operator">=</span> torch<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>self<span class="token punctuation">.</span>window_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    coords_w <span class="token operator">=</span> torch<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>self<span class="token punctuation">.</span>window_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    coords <span class="token operator">=</span> torch<span class="token punctuation">.</span>stack<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span><span class="token punctuation">[</span>coords_h<span class="token punctuation">,</span> coords_w<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 2, Wh, Ww</span>
    coords_flatten <span class="token operator">=</span> torch<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span>coords<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 2, Wh*Ww</span>
    relative_coords <span class="token operator">=</span> coords_flatten<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span> <span class="token operator">-</span> coords_flatten<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>  <span class="token comment"># 2, Wh*Ww, Wh*Ww</span>
    relative_coords <span class="token operator">=</span> relative_coords<span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>contiguous<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># Wh*Ww, Wh*Ww, 2</span>
    relative_coords<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+=</span> self<span class="token punctuation">.</span>window_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span>  <span class="token comment"># shift to start from 0</span>
    relative_coords<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> self<span class="token punctuation">.</span>window_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span>
    relative_coords<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*=</span> <span class="token number">2</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>window_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span>
    relative_position_index <span class="token operator">=</span> relative_coords<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># Wh*Ww, Wh*Ww</span>
    self<span class="token punctuation">.</span>register_buffer<span class="token punctuation">(</span><span class="token string">"relative_position_index"</span><span class="token punctuation">,</span> relative_position_index<span class="token punctuation">)</span>

    self<span class="token punctuation">.</span>qkv <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>dim<span class="token punctuation">,</span> dim <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">,</span> bias<span class="token operator">=</span>qkv_bias<span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>attn_drop <span class="token operator">=</span> nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span>attn_drop<span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>proj <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>dim<span class="token punctuation">,</span> dim<span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>proj_drop <span class="token operator">=</span> nn<span class="token punctuation">.</span>Dropout<span class="token punctuation">(</span>proj_drop<span class="token punctuation">)</span>

    trunc_normal_<span class="token punctuation">(</span>self<span class="token punctuation">.</span>relative_position_bias_table<span class="token punctuation">,</span> std<span class="token operator">=</span><span class="token number">.02</span><span class="token punctuation">)</span>
    self<span class="token punctuation">.</span>softmax <span class="token operator">=</span> nn<span class="token punctuation">.</span>Softmax<span class="token punctuation">(</span>dim<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> mask<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Args:
        x: input features with shape of (num_windows*B, N, C)
        mask: (0/-inf) mask with shape of (num_windows, Wh*Ww, Wh*Ww) or None
    """</span>
    B_<span class="token punctuation">,</span> N<span class="token punctuation">,</span> C <span class="token operator">=</span> x<span class="token punctuation">.</span>shape
    qkv <span class="token operator">=</span> self<span class="token punctuation">.</span>qkv<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>B_<span class="token punctuation">,</span> N<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>num_heads<span class="token punctuation">,</span> C <span class="token operator">//</span> self<span class="token punctuation">.</span>num_heads<span class="token punctuation">)</span><span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
    q<span class="token punctuation">,</span> k<span class="token punctuation">,</span> v <span class="token operator">=</span> qkv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> qkv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> qkv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>  <span class="token comment"># make torchscript happy (cannot use tensor as tuple)</span>

    q <span class="token operator">=</span> q <span class="token operator">*</span> self<span class="token punctuation">.</span>scale
    attn <span class="token operator">=</span> <span class="token punctuation">(</span>q @ k<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    relative_position_bias <span class="token operator">=</span> self<span class="token punctuation">.</span>relative_position_bias_table<span class="token punctuation">[</span>self<span class="token punctuation">.</span>relative_position_index<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span>
        self<span class="token punctuation">.</span>window_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>window_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>window_size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>window_size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># Wh*Ww,Wh*Ww,nH</span>
    relative_position_bias <span class="token operator">=</span> relative_position_bias<span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>contiguous<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># nH, Wh*Ww, Wh*Ww</span>
    attn <span class="token operator">=</span> attn <span class="token operator">+</span> relative_position_bias<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> mask <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        nW <span class="token operator">=</span> mask<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        attn <span class="token operator">=</span> attn<span class="token punctuation">.</span>view<span class="token punctuation">(</span>B_ <span class="token operator">//</span> nW<span class="token punctuation">,</span> nW<span class="token punctuation">,</span> self<span class="token punctuation">.</span>num_heads<span class="token punctuation">,</span> N<span class="token punctuation">,</span> N<span class="token punctuation">)</span> <span class="token operator">+</span> mask<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        attn <span class="token operator">=</span> attn<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>num_heads<span class="token punctuation">,</span> N<span class="token punctuation">,</span> N<span class="token punctuation">)</span>
        attn <span class="token operator">=</span> self<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>attn<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        attn <span class="token operator">=</span> self<span class="token punctuation">.</span>softmax<span class="token punctuation">(</span>attn<span class="token punctuation">)</span>

    attn <span class="token operator">=</span> self<span class="token punctuation">.</span>attn_drop<span class="token punctuation">(</span>attn<span class="token punctuation">)</span>

    x <span class="token operator">=</span> <span class="token punctuation">(</span>attn @ v<span class="token punctuation">)</span><span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>B_<span class="token punctuation">,</span> N<span class="token punctuation">,</span> C<span class="token punctuation">)</span>
    x <span class="token operator">=</span> self<span class="token punctuation">.</span>proj<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    x <span class="token operator">=</span> self<span class="token punctuation">.</span>proj_drop<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
    <span class="token keyword">return</span> x</span></span></span></code></pre><h3 id="https://www.notion.so/67fc91d8f3a74a4ea635deef554637a6" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/67fc91d8f3a74a4ea635deef554637a6"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">window_reverse</span></span></h3><div id="https://www.notion.so/ed991c684f95454c8a7943debb2f1703" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">å°†ä¸€ä¸ªä¸ªwindowè¿˜åŸæˆä¸€ä¸ªfeature map</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/58ba9ed0b297432eaa752b2f22815d5e" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">é¦–å…ˆï¼Œæ ¹æ®H_spå’ŒW_spè®¡ç®—å‡ºæ¯å¼ å›¾åƒåˆ’åˆ†å‡ºçš„çª—å£æ•°é‡ï¼Œå³H * W / H_sp / W_spï¼Œå¹¶ç”¨å®ƒé™¤ä»¥Bâ€™å¾—åˆ°æ‰¹é‡å¤§å°Bã€‚</span></span></li><li id="https://www.notion.so/f5acf1ceee3349a69f531dfb7a1a54db" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">ç„¶åï¼Œå°†è¾“å…¥å¼ é‡img_splits_hwé‡å¡‘ä¸º(B, H // H_sp, W // W_sp, H_sp, W_sp, C)çš„å½¢çŠ¶ï¼Œå…¶ä¸­æ¯ä¸ªç»´åº¦åˆ†åˆ«è¡¨ç¤ºæ‰¹é‡å¤§å°ï¼Œçª—å£è¡Œæ•°ï¼Œçª—å£åˆ—æ•°ï¼Œçª—å£é«˜åº¦ï¼Œçª—å£å®½åº¦å’Œé€šé“æ•°ã€‚</span></span></li><li id="https://www.notion.so/5c019786a26b4939bdec6d889d16a5a3" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">ç„¶åï¼Œå°†imgåœ¨ç¬¬äºŒç»´å’Œç¬¬å››ç»´ä¸Šè¿›è¡Œäº¤æ¢ï¼Œå¾—åˆ°(B, W // W_sp, H // H_sp, H_sp, W_sp, C)çš„å½¢çŠ¶ï¼Œå¹¶å°†å…¶å±•å¹³ä¸º(B, C, H, W)çš„å½¢çŠ¶ã€‚è¿™æ ·å°±å®ç°äº†å°†æ¯ä¸ªçª—å£å†…éƒ¨çš„å…ƒç´ æŒ‰ç…§åŸå§‹å›¾åƒçš„é¡ºåºæ’åˆ—ï¼Œå¹¶åˆå¹¶æˆä¸€ä¸ªå®Œæ•´çš„å›¾åƒã€‚</span></span></li></ul><div id="https://www.notion.so/c6d873b3d96d4185b0462ddfba62dd99" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/bfcdc4ff5f954c94ac482a062af79115" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token keyword">def</span> <span class="token function">windows2img</span><span class="token punctuation">(</span>img_splits_hw<span class="token punctuation">,</span> H_sp<span class="token punctuation">,</span> W_sp<span class="token punctuation">,</span> H<span class="token punctuation">,</span> W<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    img_splits_hw: B' H W C
    """</span>
    B <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>img_splits_hw<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token punctuation">(</span>H <span class="token operator">*</span> W <span class="token operator">/</span> H_sp <span class="token operator">/</span> W_sp<span class="token punctuation">)</span><span class="token punctuation">)</span>

    img <span class="token operator">=</span> img_splits_hw<span class="token punctuation">.</span>view<span class="token punctuation">(</span>B<span class="token punctuation">,</span> H <span class="token operator">//</span> H_sp<span class="token punctuation">,</span> W <span class="token operator">//</span> W_sp<span class="token punctuation">,</span> H_sp<span class="token punctuation">,</span> W_sp<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    img <span class="token operator">=</span> img<span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>contiguous<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>view<span class="token punctuation">(</span>B<span class="token punctuation">,</span> img<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>H<span class="token punctuation">,</span>W<span class="token punctuation">)</span>
    <span class="token keyword">return</span> img</span></span></span></code></pre><blockquote id="https://www.notion.so/30fed9c7ad9443c999175be3643c45b3" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://zhuanlan.zhihu.com/p/367111046">å›¾è§£Swin Transformer - çŸ¥ä¹ (zhihu.com)</a></span></span></blockquote><h2 id="https://www.notion.so/7b53ca2c4587430682870178357d5866" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/7b53ca2c4587430682870178357d5866"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Swin transformer V2</span></span></h2><blockquote id="https://www.notion.so/cbc20a9198d549b28b634a64b582d7c9" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://sh-tsang.medium.com/review-swin-transformer-v2-scaling-up-capacity-and-resolution-401c28b02df8">https://sh-tsang.medium.com/review-swin-transformer-v2-scaling-up-capacity-and-resolution-401c28b02df8</a></span></span></blockquote><div id="https://www.notion.so/93784b43cd844e37be4ba39b2febfcfc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">æœ¬æ–‡æ˜¯Swin-Tå›¢é˜Ÿåœ¨Swin-Tæ¨¡å‹çš„åŸºç¡€ä¸Šå¯¹scale upè§†è§‰æ¨¡å‹çš„ä¸€ä¸ªå·¥ä½œï¼Œåœ¨4ä¸ªæ•°æ®é›†ä¸Šåˆé‡æ–°åˆ·åˆ°äº†æ–°çš„SOTAæ–‡ç« çš„å‡ºå‘ç‚¹æ˜¯ï¼Œåœ¨è§†è§‰é¢†åŸŸé‡Œå¹¶æ²¡æœ‰åƒNLPé‚£æ ·ï¼Œå¯¹äºå¢å¤§æ¨¡å‹scaleæœ‰æ¯”è¾ƒå¥½çš„æ¢ç´¢ï¼Œæ–‡ä¸­è®²åˆ°å¯èƒ½çš„åŸå› æ˜¯ï¼š</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/81295b7dd88a499d95a08a71d2f83df6" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">åœ¨</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">å¢å¤§è§†è§‰æ¨¡å‹çš„æ—¶å¯èƒ½ä¼šå¸¦æ¥å¾ˆå¤§çš„è®­ç»ƒä¸ç¨³å®šæ€§</strong></span></span></li><li id="https://www.notion.so/7ccc3282d5034347aca9779b09f35212" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">åœ¨å¾ˆå¤šéœ€è¦é«˜åˆ†è¾¨ç‡çš„ä¸‹æ¸¸ä»»åŠ¡ä¸Šï¼Œè¿˜æ²¡æœ‰å¾ˆå¥½çš„æ¢ç´¢å‡ºæ¥</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">å¯¹ä½åˆ†è¾¨ç‡ä¸‹è®­ç»ƒå¥½çš„æ¨¡å‹è¿ç§»åˆ°æ›´å¤§scaleæ¨¡å‹ä¸Š</strong></span><span class="SemanticString">çš„æ–¹æ³•</span></span></li></ul><h3 id="https://www.notion.so/9764cc37994644ed8690fe056ab6fe46" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/9764cc37994644ed8690fe056ab6fe46"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">ä¸‰ç§æŠ€æœ¯</span></span></h3><div id="https://www.notion.so/2faabb203f984750ab0d98c90446b4a6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">æå‡ºäº†ä¸‰ç§ä¸»è¦æŠ€æœ¯ï¼š1) ç»“åˆä½™å¼¦æ³¨æ„åŠ›çš„æ®‹å·®åè§„èŒƒæ–¹æ³•ï¼Œä»¥æé«˜è®­ç»ƒçš„ç¨³å®šæ€§ï¼›2) å¯¹æ•°é—´éš”è¿ç»­ä½ç½®åç½®æ–¹æ³•ï¼Œä»¥æœ‰æ•ˆåœ°å°†ä½¿ç”¨ä½åˆ†è¾¨ç‡å›¾åƒé¢„è®­ç»ƒçš„æ¨¡å‹è½¬ç§»åˆ°é«˜åˆ†è¾¨ç‡è¾“å…¥çš„ä¸‹æ¸¸ä»»åŠ¡ä¸­ï¼›3) è‡ªç›‘ç£é¢„è®­ç»ƒæ–¹æ³• SimMIMï¼Œä»¥å‡å°‘å¯¹å¤§é‡æ ‡è®°å›¾åƒçš„éœ€æ±‚ã€‚</span></span></p></div><div id="https://www.notion.so/5127ab8583e4465cb333567a3149da64" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2Fa8cdbe71-2f5b-4ea6-a395-265c789c4a19%2FUntitled.png?width=624&amp;table=block&amp;id=5127ab85-83e4-465c-b333-567a3149da64"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2Fa8cdbe71-2f5b-4ea6-a395-265c789c4a19%2FUntitled.png?width=624&amp;table=block&amp;id=5127ab85-83e4-465c-b333-567a3149da64" style="width:624px"/></a><figcaption><span class="SemanticStringArray"><span class="SemanticString">ä¸ºäº†æ›´å¥½åœ°æ‰©å±•æ¨¡å‹å®¹é‡å’Œçª—å£åˆ†è¾¨ç‡ï¼Œæˆ‘ä»¬å¯¹åŸæœ‰çš„ Swin Transformer æ¶æ„ï¼ˆV1ï¼‰è¿›è¡Œäº†å¤šé¡¹è°ƒæ•´ï¼š1) ä»¥é‡åè§„èŒƒå–ä»£ä¹‹å‰çš„å‰è§„èŒƒé…ç½®ï¼›2) ä»¥æ¯”ä¾‹ä½™å¼¦å…³æ³¨å–ä»£åŸæ¥çš„ç‚¹ç§¯å…³æ³¨ï¼›3) ä»¥å¯¹æ•°é—´éš”çš„è¿ç»­ç›¸å¯¹ä½ç½®åç½®æ–¹æ³•å–ä»£ä¹‹å‰çš„å‚æ•°åŒ–æ–¹æ³•ã€‚é€‚åº”æ€§ 1) å’Œ 2) ä½¿æ¨¡å‹æ›´å®¹æ˜“æ‰©å¤§å®¹é‡ã€‚é€‚åº”æ€§ 3) ä½¿æ¨¡å‹èƒ½æ›´æœ‰æ•ˆåœ°è·¨çª—å£åˆ†è¾¨ç‡è½¬ç§»ã€‚ç»è¿‡è°ƒæ•´çš„æ¶æ„è¢«å‘½åä¸º Swin Transformer V2ã€‚</span></span></figcaption></figure></div><div id="https://www.notion.so/6dedbcfe364543d7bce90e2ed0e0a72d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h3 id="https://www.notion.so/b33869299bbc4ca9a52a43084687ab76" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/b33869299bbc4ca9a52a43084687ab76"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Post normalization</span></span></h3><div id="https://www.notion.so/31af5c0cc5714b459645811e3a9417c5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">ä¸ºç¼“è§£è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬å»ºè®®é‡‡ç”¨æ®‹å·®åå½’ä¸€åŒ–æ–¹æ³•ï¼Œå¦‚å›¾ </span><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Resource"><a href=""><span class="SemanticStringArray"><span class="SemanticString">Unknown Page</span></span></a></span></span><span class="SemanticString"> æ‰€ç¤ºã€‚åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œæ¯ä¸ªæ®‹å·®å—çš„è¾“å‡ºåœ¨åˆå¹¶å›ä¸»åˆ†æ”¯ä¹‹å‰éƒ½ä¼šè¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œå½“å±‚æ·±å…¥æ—¶ï¼Œä¸»åˆ†æ”¯çš„æŒ¯å¹…ä¸ä¼šç´¯ç§¯ã€‚å¦‚å›¾ </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://www.notion.so/402fabb8d72a44e8a65f5977ac393f14?pvs=25#fae13bce13f247ddb64e749ff4d7d8bb">2</a></span><span class="SemanticString"> æ‰€ç¤ºï¼Œè¿™ç§æ–¹æ³•çš„æ¿€æ´»æŒ¯å¹…æ¯”åŸæ¥çš„é¢„å½’ä¸€åŒ–é…ç½®è¦æ¸©å’Œå¾—å¤šã€‚</span></span></p></div><div id="https://www.notion.so/fbdb46061e764fbcb7ad6bb308e1c440" class="ColumnList"><div id="https://www.notion.so/252f41fecadf4289a387da90bea6ab7c" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/888edea4ac604f1fb423843d6840b887" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2Fbfd00ace-0712-43fd-9f71-95c35b16f066%2FUntitled.png?width=192&amp;table=block&amp;id=888edea4-ac60-4f1f-b423-843d6840b887"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2Fbfd00ace-0712-43fd-9f71-95c35b16f066%2FUntitled.png?width=192&amp;table=block&amp;id=888edea4-ac60-4f1f-b423-843d6840b887" style="width:192px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div><div id="https://www.notion.so/92b72f38305645eca558b99875c33159" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/04b7dd5d19a04f10b412f74057deb04a" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F3fffe886-4acf-4995-aec8-f98ae1d10ec3%2FUntitled.png?width=188&amp;table=block&amp;id=04b7dd5d-19a0-4f10-b412-f74057deb04a"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2F3fffe886-4acf-4995-aec8-f98ae1d10ec3%2FUntitled.png?width=188&amp;table=block&amp;id=04b7dd5d-19a0-4f10-b412-f74057deb04a" style="width:188px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div></div></div><div id="https://www.notion.so/fae3bb7e88a0486385180d36cb386cbc" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2Fce393c7c-32e2-4f7c-8775-ea63da4e03f7%2FUntitled.png?width=565&amp;table=block&amp;id=fae3bb7e-88a0-4863-8518-0d36cb386cbc"><img src="https://www.notion.so/signed/https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Ff3e18bd5-e2f1-4629-b637-ae7fa3ad4ab2%2Fce393c7c-32e2-4f7c-8775-ea63da4e03f7%2FUntitled.png?width=565&amp;table=block&amp;id=fae3bb7e-88a0-4863-8518-0d36cb386cbc" style="width:565px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><h3 id="https://www.notion.so/e141c8c14bf54eb89cfc959ac3be0f1e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/e141c8c14bf54eb89cfc959ac3be0f1e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Scaled cosine attention</span></span></h3><div id="https://www.notion.so/7b11c893e13745d6b09d1637f532f91b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">åœ¨æœ€åˆçš„è‡ªæˆ‘æ³¨æ„åŠ›è®¡ç®—ä¸­ï¼Œåƒç´ å¯¹çš„ç›¸ä¼¼æ€§é¡¹æ˜¯ä½œä¸ºæŸ¥è¯¢å‘é‡å’Œå…³é”®å‘é‡çš„ç‚¹ç§¯æ¥è®¡ç®—çš„ã€‚æˆ‘ä»¬å‘ç°ï¼Œåœ¨å¤§å‹è§†è§‰æ¨¡å‹ä¸­ä½¿ç”¨è¿™ç§æ–¹æ³•æ—¶ï¼Œä¸€äº›åŒºå—å’Œå¤´éƒ¨çš„å­¦ä¹ æ³¨æ„åŠ›å›¾ç»å¸¸è¢«å°‘æ•°åƒç´ å¯¹æ‰€æ”¯é…ï¼Œå°¤å…¶æ˜¯åœ¨é‡åè§„èŒƒé…ç½®ä¸­ã€‚ä¸ºäº†ç¼“è§£è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§ç¼©æ”¾ä½™å¼¦æ³¨æ„åŠ›æ–¹æ³•ï¼Œå³é€šè¿‡ç¼©æ”¾ä½™å¼¦å‡½æ•°è®¡ç®—åƒç´ å¯¹ i å’Œ j çš„æ³¨æ„åŠ›å¯¹æ•°ï¼š</span></span></p></div><div id="https://www.notion.so/6802513d3afa4592b02deee1f002eddb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><span class="SemanticString__Fragment SemanticString__Fragment--Math" data-latex="Sim(q_i,k_j) = cos(q_i,k_j)/ \tau+B_{ij}"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>i</mi><mi>m</mi><mo stretchy="false">(</mo><msub><mi>q</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><msub><mi>q</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>Ï„</mi><mo>+</mo><msub><mi>B</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Sim(q_i,k_j) = cos(q_i,k_j)/ \tau+B_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.1132em;">Ï„</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></p></div><div id="https://www.notion.so/0eaae1a0648c44c1b68b031d58055568" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">å…¶ä¸­ï¼ŒBij æ˜¯åƒç´  i å’Œ j ä¹‹é—´çš„ç›¸å¯¹ä½ç½®åå·®ï¼›Ï„ æ˜¯ä¸€ä¸ªå¯å­¦ä¹ çš„æ ‡é‡ï¼Œä¸è·¨å¤´å’Œå±‚å…±äº«ã€‚</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">ä½™å¼¦å‡½æ•°æ˜¯è‡ªç„¶å½’ä¸€åŒ–çš„ï¼Œå› æ­¤å¯ä»¥æœ‰è¾ƒæ¸©å’Œçš„æ³¨æ„åŠ›å€¼ã€‚</strong></span></span></p></div><div id="https://www.notion.so/bd465809e4804796a54647a2d3ddfcfe" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h3 id="https://www.notion.so/6c8c529f26f4455ca98d9ed29b0649ba" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/6c8c529f26f4455ca98d9ed29b0649ba"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">åŸå§‹å‚æ•°åŒ–ç›¸å¯¹ä½ç½®åå·®</span></span></h3><ul class="BulletedListWrapper"><li id="https://www.notion.so/01b17e23c1c14325accc872c242c82ae" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">æ²¿æ¯ä¸ªè½´çš„ç›¸å¯¹ä½ç½®åœ¨[- </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">M</strong></em></span><span class="SemanticString"> </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">+1,</strong></span><span class="SemanticString"> </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">M</strong></em></span><span class="SemanticString"> </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">+1]èŒƒå›´</strong></span><span class="SemanticString">å†…ï¼Œå¹¶ä¸”ç›¸å¯¹ä½ç½®åå·®è¢«å‚æ•°åŒ–ä¸º</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">åå·®çŸ©é˜µ ^ </strong></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">B</strong></em></span><span class="SemanticString">ã€‚</span></span></li><li id="https://www.notion.so/2ac7942d12334eefb3891187fa49d968" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">å½“è·¨ä¸åŒçª—å£å¤§å°è¿›è¡Œè¿ç§»æ—¶</strong></span><span class="SemanticString">ï¼Œé¢„è®­ç»ƒä¸­</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">å­¦ä¹ åˆ°çš„ç›¸å¯¹ä½ç½®åç½®çŸ©é˜µ</strong></span><span class="SemanticString">ç”¨äº</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">é€šè¿‡åŒä¸‰æ¬¡æ’å€¼æ¥åˆå§‹åŒ–å¾®è°ƒ</strong></span><span class="SemanticString">ä¸­</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">ä¸åŒå¤§å°çš„åç½®çŸ©é˜µã€‚</strong></span></span></li></ul><h3 id="https://www.notion.so/78aed22194e54896b287e8c8b9fb5f5d" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/78aed22194e54896b287e8c8b9fb5f5d"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Swin V2 çº¿æ€§é—´éš”è¿ç»­ä½ç½®åç½® (CPB)</span></span></h3><div id="https://www.notion.so/d36914748e314d1bbf28383f7bb8a346" class="Image Image--Normal"><figure><a href="#?width=144"><img src="#?width=144" style="width:144px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/f4d5ebf2729a4fa5a8aaf0150052b513" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Swin V2 çº¿æ€§é—´éš” CPBã€‚</strong></span><span class="SemanticString">ï¼ˆä» Swin V2 å—è£å‰ªï¼‰</span></span></p></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/19fd9e2d5d4540299a50e9675265c2a8" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">è¿ç»­</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">ä½ç½®åå·®ï¼ˆCPBï¼‰æ–¹æ³•åœ¨ç›¸å¯¹åæ ‡ä¸Šé‡‡ç”¨å°å‹å…ƒç½‘ç»œï¼š</strong></span></span></li></ul><div id="https://www.notion.so/f7051d56ed084dffbfdc286060f2f53b" class="Image Image--Normal"><figure><a href="#?width=288"><img src="#?width=288" style="width:288px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><ul class="BulletedListWrapper"><li id="https://www.notion.so/b1a566f2bd434671baac757c62e6b022" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">å…¶ä¸­</span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">G</em></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">æ˜¯ä¸€ä¸ª</strong></span><span class="SemanticString">å°å‹ç½‘ç»œï¼Œä¾‹å¦‚é»˜è®¤æƒ…å†µä¸‹å…·æœ‰</span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://sh-tsang.medium.com/brief-review-rectified-linear-units-improve-restricted-boltzmann-machines-43724ede3ecf">ReLUæ¿€æ´»çš„</a></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">2 å±‚ MLP ã€‚</strong></span><span class="SemanticString">ï¼ˆå®ƒæ˜¯Swin V2å—å›¾ä¸­çš„â€œMLPâ€ã€‚ï¼‰</span></span></li><li id="https://www.notion.so/1a38f215a3384c0289edb49e230866ae" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString">å…ƒ</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">ç½‘ç»œ_G_ä¸ºä»»æ„ç›¸å¯¹åæ ‡ ç”Ÿæˆåå·®å€¼</strong></span><span class="SemanticString">ï¼Œå› æ­¤å¯ä»¥</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">è‡ªç„¶åœ°è½¬ç§»åˆ°å…·æœ‰ä»»æ„å˜åŒ–çª—å£å¤§å°çš„å¾®è°ƒä»»åŠ¡ã€‚</strong></span></span></li><li id="https://www.notion.so/cdf28f77bf674d0db3487b32c2826d94" class="BulletedList"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">åœ¨æ¨è®ºä¸­ï¼Œå¯ä»¥é¢„å…ˆè®¡ç®—</strong></span><span class="SemanticString">æ¯ä¸ªç›¸å¯¹ä½ç½®çš„åå·®å€¼å¹¶å°†å…¶å­˜å‚¨ä¸ºæ¨¡å‹å‚æ•°ã€‚</span></span></li></ul></article>
  <footer class="Footer">
  <div>&copy; Simonâ€™s Blogs 2022</div>
  <div>&centerdot;</div>
  <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
      rel="noopener noreferrer">Notablog</a>.
  </div>
</footer>
</body>

</html>